!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("backbone"),require("jquery"),require("underscore")):"function"==typeof define&&define.amd?define(["backbone","jquery","underscore"],r):"object"==typeof exports?exports.Warby=r(require("backbone"),require("jquery"),require("underscore")):t.Warby=r(t.Backbone,t.jQuery,t._)}(this,function(t,r,e){return function(t){function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}var e={};return r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},r.p="",r(r.s=10)}([function(r,e){r.exports=t},function(t,r,e){"use strict";function n(t,r,e,i,s){for(var a in i)"__self__"===a?i.__self__.length&&(e.__self__=e.__self__||{},e.__self__[r]=!0,t.model.set(s+"$"+r,!0)):(e[a]=e[a]||{},n(t,r,e[a],i[a],s+a+"_"));o(t,e,s)}function i(t,r,e,n){for(var a in e)if("__self__"===a)for(var l=r.length-1;l>=0;l--){var u=r[l];delete e.__self__[u],t.model.unset(n+"$"+u)}else s.isObject(e[a])&&i(t,r,e[a],n+a+"_");o(t,e,n)}function o(t,r,e){var n,i=!0;r.__self__=r.__self__||{};for(n in r.__self__)"invalid"!==n&&"valid"!==n&&r.__self__[n]&&(i=!1);if(i)for(n in r)"__self__"!==n&&r[n].__self__.invalid&&(i=!1);r.__self__.invalid=!i,r.__self__.valid=i,t.model.set(e+"$invalid",!i),t.model.set(e+"$valid",i)}var s=e(5),a=e(0),l=function(){this.model=new a.Model({$invalid:!1,$valid:!0}),this.status={__self__:{invalid:!1,valid:!0}}};l.prototype.loadErrors=function(t,r,e){var i=[],s=[this.status];if(null!=e)for(var a=e.split("."),l=0,u=a.length;l<u;l++){var f=a[l];if(""===f)throw new Error("Invalid base '"+e+"'");if("__self__"===f)throw new Error("Mustn't use '__self__' in base '"+e+"'");var c=s[l];c[f]=c[f]||{},s.push(c[f]),i.push(f)}for(n(this,t,s.pop(),r,i.length?i.join("_")+"_":""),l=i.length-1;l>=0;l--)o(this,s[l],l?i.slice(0,l).join("_")+"_":"")},l.prototype.removeErrors=function(t,r){var e=[],n=[this.status];if(s.isArray(t)||(t=[t]),null!=r)for(var a=r.split("."),l=0,u=a.length;l<u;l++){var f=a[l];if(""===f)throw new Error("Invalid base '"+r+"'");if("__self__"===f)throw new Error("Mustn't use '__self__' in base '"+r+"'");var c=n[l];c[f]=c[f]||{},n.push(c[f]),e.push(f)}for(i(this,t,n.pop(),e.length?e.join("_")+"_":""),l=e.length-1;l>=0;l--)o(this,n[l],l?e.slice(0,l).join("_")+"_":"")},l.prototype.set=function(t,r){for(var e=t.split("."),n=[],i=[this.status],s=0,a=e.length;s<a;s++){var l=e[s];if(""===l)throw new Error("Invalid keypath '"+t+"'");if("__self__"===l)throw new Error("Mustn't use '__self__' in keypath '"+t+"'");var u=i[s];if(s+1===a){u.__self__=u.__self__||{},u.__self__[l]=r,this.model.set((s?n.join("_")+"_$":"$")+l,r);break}u[l]=u[l]||{},i.push(u[l]),n.push(l)}for(s=i.length-1;s>=0;s--)o(this,i[s],s?n.slice(0,s).join("_")+"_":"")},t.exports=l},function(t,r,e){"use strict";var n=e(4),i=function(t){if(t=null==t?{}:t,null==t.name||""===t.name)throw new Error("Undefined 'settings.name' param");this.name=t.name};i.prototype.getWidgetObj=function(){return n("#"+this.name)},t.exports=i},function(t,r,e){"use strict";var n=e(4),i={__config:null,__widgets:{}};i.createWidget=function(t){var r=t.constructor;if(r in this.__widgets)return new i.__widgets[r](t);throw new Error("Can't find widget '"+r+"'")},i.getBaseUrl=function(){var t=n("base").attr("href")||"";return t&&"/"!==t.charAt(t.length-1)?t+"/":t},i.getConfig=function(){return null==this.__config&&(this.__config=JSON.parse(n(".template-config").html())),this.__config},i.getLang=function(){var t=this.getConfig().lang;return null==t?"en":t},i.directTo=function(t){var r,e,i;t=null==t?{}:t,t instanceof Object?(r=null==t.method?"get":t.method,e=null==t.params?{}:t.params,i=null==t.url?"":t.url):(r="get",e={},i=null==t?"":t);var o=n('<form class="hidden" method="'+r+'" action="'+i+'"></form>').appendTo(n("body"));if(e instanceof Array)for(var s=0,a=e.length;s<a;s++)o.append('<input name="'+e[s].name+'" value="'+e[s].value+'">');else for(var l in e)if(e[l]instanceof Array)for(var u=0,f=e[l].length;u<f;u++)o.append('<input name="'+l+'" value="'+e[l][u]+'">');else o.append('<input name="'+l+'" value="'+e[l]+'">');o.submit()},i.registerWidget=function(t,r){if(t in this.__widgets)throw new Error("Widget '"+t+"' has  already been registered");this.__widgets[t]=r},i.url=function(t){var r,e,o,s;return t=null==t?{}:t,t instanceof Object?(r=null==t.adr?"":t.adr,e=null==t.base?i.getBaseUrl():t.base,o=null==t.params?"":n.param(t.params)):(r=t,e=i.getBaseUrl(),o=""),null!=e&&""!==e&&"/"!==e&&"/"===r.charAt(0)?("/"===e.charAt(e.length-1)&&(r=r.substring(1)),s=e+r):s=r,o&&(o=(s.indexOf("?")>=0?"&":"?")+o),s+o},t.exports=i},function(t,e){t.exports=r},function(t,r){t.exports=e},function(t,r,e){"use strict";function n(t){return function(r,e,n){var i={};i[t]=e,r.validate(i,n)}}var i=e(0),o=e(1),s=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;t.exports=i.Model.extend({constructor:function(){i.Model.apply(this,arguments);var t=this;for(var r in this.attributes)this.on("change:"+r,n(r));this.errors={},this.handlers={error:function(r){r&&r.errors?(t.errors=r.errors,t.validityStatus.loadErrors("serviceValidity",r.errors)):(t.errors={},t.validityStatus.set("serviceError",!0))}},this.validityStatus=new o},assertEmail:function(t,r){return this.makeValidation(t,s.test(r))},makeValidation:function(t,r){return this.validityStatus.set(t,!r),r},validate:function(){if(this.validityStatus.removeErrors(["serviceError","serviceValidity"]),this.errors={},this.validityStatus.status.__self__.invalid)return"Form is invalid"}})},function(t,r,e){"use strict";function n(t,r,e){for(var n=e.split("."),i=0,o=n.length;i<o;i++){var s=n[i];i===o-1?r[s]=t[s]:(r[s]=r[s]||{},t=t[s],r=r[s])}}function i(t,r){if(t.api){var e=t.api[r];return e||(e=i(t.constructor.__super__,r)),e}}function o(t,r){if(t.apiMapping){var e=t.apiMapping[r];return e||(e=o(t.constructor.__super__,r)),e}}function s(t,r){for(var e=r.split("."),n=t,i=0,o=e.length;i<o;i++)n=n[e[i]];return n}function a(t,r){var e={};if(u.isArray(r))for(var i=0,o=r.length;i<o;i++)n(t,e,r[i]);else for(var a in r)e[r[a]]=s(t,a);return e}function l(t,r,e){var n=t.url,i=e.path;if(i.length>0){"/"===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1));for(var o=i.split("/"),a=0,l=o.length;a<l;a++){var u,f=o[a];u="{"===f.charAt(0)&&"}"===f.charAt(f.length-1)?s(r,f.substring(1,f.length-1)):f,""!==u.toString()&&(n+="/"+encodeURIComponent(u))}"/"===i.charAt(i.length-1)&&(n+="/")}return n}var u=e(5),f=e(0),c=e(3),_=function(){};u.extend(_.prototype,{url:null,api:{},apply:function(t,r){var e=i(this,t);if(e)return e.func.apply(this,r)},bind:function(t){t&&(t.service=this,t.sync=function(){return _.sync.apply(this,arguments)})},call:function(t){var r=i(this,t);if(r){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,1);return r.func.apply(this,e)}return r.func.call(this)}},provider:null}),_.extend=f.Model.extend,_.sync=function(t,r,e){if(e||(e={}),e.apiMethod)t=e.apiMethod;else if(!(t=o(r,t)))throw new Error("Unsupported sync method '"+t+"'");var n=i(r.service,t);if(!n)throw new Error("Unsupported API method '"+t+"'");var s=void 0!==n.provider?n.provider:r.service.provider;s&&s(r,e);var _=u.extend(r.toJSON(e),e.attrs),p=n.type,d=l(r.service,_,n);n.params&&(d=c.url({adr:d,base:"",params:a(_,n.params)}));var h={dataType:"json",type:p,url:d};void 0!==e.data||!r||"POST"!==p&&"PUT"!==p&&"PATCH"!==p||(h.contentType="application/json",h.data=JSON.stringify(e.attrs||r.toJSON(e)),h.processData=!1);var v=e.xhr=f.ajax(u.extend(h,e));return r.trigger("request",r,v,e),v},t.exports=_},function(t,r,e){"use strict";var n=e(2),i=function(t){t=null==t?{}:t,t.name=null==t.name?"content-widget":t.name,n.call(this,t)};i.prototype=Object.create(n.prototype),i.prototype.constructor=i,t.exports=i},function(t,r,e){"use strict";t.exports=function(t,r){var e=r.success;r.success=function(t){switch(t.status){case"INVALID":r.error&&r.error(t.errors);break;case"SUCCESS":e&&e(t.data);break;default:r.error&&r.error()}}}},function(t,r,e){r.Form=e(6),r.Service=e(7),r.ValidityStatus=e(1),r.View=e(8),r.Widget=e(2),r.restyProvider=e(9),r.template=e(3)}])});