!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("jquery"),require("underscore")):"function"==typeof define&&define.amd?define(["backbone","jquery","underscore"],t):"object"==typeof exports?exports.Warby=t(require("backbone"),require("jquery"),require("underscore")):r.Warby=t(r.Backbone,r.jQuery,r._)}(this,function(r,t,e){return function(r){function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var e={};return t.m=r,t.c=e,t.i=function(r){return r},t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:n})},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},t.p="",t(t.s=10)}([function(t,e){t.exports=r},function(r,e){r.exports=t},function(r,t){r.exports=e},function(r,t,e){"use strict";function n(r){return function(t,e,n){var i={};i[r]=e,t.validate(i,n)}}var i=e(0),o=e(7),s=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;r.exports=i.Model.extend({constructor:function(){i.Model.apply(this,arguments);var r=this;for(var t in this.attributes)this.on("change:"+t,n(t));this.errors={},this.handlers={error:function(t){t&&t.errors?(r.errors=t.errors,r.validityStatus.loadErrors("serviceValidity",t.errors)):(r.errors={},r.validityStatus.set("serviceError",!0))}},this.validityStatus=new o},assertEmail:function(r,t){return this.makeValidation(r,s.test(t))},makeValidation:function(r,t){return this.validityStatus.set(r,!t),t},validate:function(){if(this.validityStatus.removeErrors(["serviceError","serviceValidity"]),this.errors={},this.validityStatus.status.__self__.invalid)return"Form is invalid"}})},function(r,t,e){"use strict";function n(r,t,e){for(var n=e.split("."),i=0,o=n.length;i<o;i++){var s=n[i];i===o-1?t[s]=r[s]:(t[s]=t[s]||{},r=r[s],t=t[s])}}function i(r,t){if(r.api){var e=r.api[t];return e||(e=i(r.constructor.__super__,t)),e}}function o(r,t){if(r.apiMapping){var e=r.apiMapping[t];return e||(e=o(r.constructor.__super__,t)),e}}function s(r,t){for(var e=t.split("."),n=r,i=0,o=e.length;i<o;i++)n=n[e[i]];return n}function a(r,t){var e={};if(u.isArray(t))for(var i=0,o=t.length;i<o;i++)n(r,e,t[i]);else for(var a in t)e[t[a]]=s(r,a);return e}function l(r,t,e){var n=r.url,i=e.path;if(i.length>0){"/"===n.charAt(n.length-1)&&(n=n.substring(0,n.length-1));for(var o=i.split("/"),a=0,l=o.length;a<l;a++){var u,f=o[a];u="{"===f.charAt(0)&&"}"===f.charAt(f.length-1)?s(t,f.substring(1,f.length-1)):f,""!==u.toString()&&(n+="/"+encodeURIComponent(u))}"/"===i.charAt(i.length-1)&&(n+="/")}return n}var u=e(2),f=e(0),c=e(9),_=function(){};u.extend(_.prototype,{url:null,api:{},apply:function(r,t){var e=i(this,r);if(e)return e.func.apply(this,t)},bind:function(r){r&&(r.service=this,r.sync=function(){return _.sync.apply(this,arguments)})},call:function(r){var t=i(this,r);if(t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,1);return t.func.apply(this,e)}return t.func.call(this)}},provider:null}),_.extend=f.Model.extend,_.sync=function(r,t,e){if(e||(e={}),e.apiMethod)r=e.apiMethod;else if(!(r=o(t,r)))throw new Error("Unsupported sync method '"+r+"'");var n=i(t.service,r);if(!n)throw new Error("Unsupported API method '"+r+"'");var s=void 0!==n.provider?n.provider:t.service.provider;s&&s(t,e);var _=u.extend(t.toJSON(e),e.attrs),p=n.type,h=l(t.service,_,n);n.params&&(h=c.url({adr:h,base:"",params:a(_,n.params)}));var d={dataType:"json",type:p,url:h};void 0!==e.data||!t||"POST"!==p&&"PUT"!==p&&"PATCH"!==p||(d.contentType="application/json",d.data=JSON.stringify(e.attrs||t.toJSON(e)),d.processData=!1);var v=e.xhr=f.ajax(u.extend(d,e));return t.trigger("request",t,v,e),v},r.exports=_},function(r,t,e){"use strict";var n=e(8),i=function(r){r=null==r?{}:r,r.name=null==r.name?"content-widget":r.name,n.call(this,r)};i.prototype=Object.create(n.prototype),i.prototype.constructor=i,r.exports=i},function(r,t,e){"use strict";r.exports=function(r,t){var e=t.success;t.success=function(r){switch(r.status){case"INVALID":t.error&&t.error(r.errors);break;case"SUCCESS":e&&e(r.data);break;default:t.error&&t.error()}}}},function(r,t,e){"use strict";function n(r,t,e,i,s){for(var a in i)"__self__"===a?i.__self__.length&&(e.__self__=e.__self__||{},e.__self__[t]=!0,r.model.set(s+"$"+t,!0)):(e[a]=e[a]||{},n(r,t,e[a],i[a],s+a+"_"));o(r,e,s)}function i(r,t,e,n){for(var a in e)if("__self__"===a)for(var l=t.length-1;l>=0;l--){var u=t[l];delete e.__self__[u],r.model.unset(n+"$"+u)}else s.isObject(e[a])&&i(r,t,e[a],n+a+"_");o(r,e,n)}function o(r,t,e){var n,i=!0;t.__self__=t.__self__||{};for(n in t.__self__)"invalid"!==n&&"valid"!==n&&t.__self__[n]&&(i=!1);if(i)for(n in t)"__self__"!==n&&t[n].__self__.invalid&&(i=!1);t.__self__.invalid=!i,t.__self__.valid=i,r.model.set(e+"$invalid",!i),r.model.set(e+"$valid",i)}var s=e(2),a=e(0),l=function(){this.model=new a.Model({$invalid:!1,$valid:!0}),this.status={__self__:{invalid:!1,valid:!0}}};l.prototype.loadErrors=function(r,t,e){var i=[],s=[this.status];if(null!=e)for(var a=e.split("."),l=0,u=a.length;l<u;l++){var f=a[l];if(""===f)throw new Error("Invalid base '"+e+"'");if("__self__"===f)throw new Error("Mustn't use '__self__' in base '"+e+"'");var c=s[l];c[f]=c[f]||{},s.push(c[f]),i.push(f)}for(n(this,r,s.pop(),t,i.length?i.join("_")+"_":""),l=i.length-1;l>=0;l--)o(this,s[l],l?i.slice(0,l).join("_")+"_":"")},l.prototype.removeErrors=function(r,t){var e=[],n=[this.status];if(s.isArray(r)||(r=[r]),null!=t)for(var a=t.split("."),l=0,u=a.length;l<u;l++){var f=a[l];if(""===f)throw new Error("Invalid base '"+t+"'");if("__self__"===f)throw new Error("Mustn't use '__self__' in base '"+t+"'");var c=n[l];c[f]=c[f]||{},n.push(c[f]),e.push(f)}for(i(this,r,n.pop(),e.length?e.join("_")+"_":""),l=e.length-1;l>=0;l--)o(this,n[l],l?e.slice(0,l).join("_")+"_":"")},l.prototype.set=function(r,t){for(var e=r.split("."),n=[],i=[this.status],s=0,a=e.length;s<a;s++){var l=e[s];if(""===l)throw new Error("Invalid keypath '"+r+"'");if("__self__"===l)throw new Error("Mustn't use '__self__' in keypath '"+r+"'");var u=i[s];if(s+1===a){u.__self__=u.__self__||{},u.__self__[l]=t,this.model.set((s?n.join("_")+"_$":"$")+l,t);break}u[l]=u[l]||{},i.push(u[l]),n.push(l)}for(s=i.length-1;s>=0;s--)o(this,i[s],s?n.slice(0,s).join("_")+"_":"")},r.exports=l},function(r,t,e){"use strict";var n=e(1),i=function(r){if(r=null==r?{}:r,null==r.name||""===r.name)throw new Error("Undefined 'settings.name' param");this.name=r.name};i.prototype.getWidgetObj=function(){return n("#"+this.name)},r.exports=i},function(r,t,e){"use strict";var n=e(1),i={__config:null};i.createWidget=function(r){return new(o(r.constructor))(r)},i.getBaseUrl=function(){var r=n("base").attr("href")||"";return r&&"/"!==r.charAt(r.length-1)?r+"/":r},i.getConfig=function(){return null==this.__config&&(this.__config=JSON.parse(n(".template-config").html())),this.__config},i.getLang=function(){var r=this.getConfig().lang;return null==r?"en":r},i.directTo=function(r){var t,e,i;r=null==r?{}:r,r instanceof Object?(t=null==r.method?"get":r.method,e=null==r.params?{}:r.params,i=null==r.url?"":r.url):(t="get",e={},i=null==r?"":r);var o=n('<form class="hidden" method="'+t+'" action="'+i+'"></form>').appendTo(n("body"));if(e instanceof Array)for(var s=0,a=e.length;s<a;s++)o.append('<input name="'+e[s].name+'" value="'+e[s].value+'">');else for(var l in e)if(e[l]instanceof Array)for(var u=0,f=e[l].length;u<f;u++)o.append('<input name="'+l+'" value="'+e[l][u]+'">');else o.append('<input name="'+l+'" value="'+e[l]+'">');o.submit()},i.url=function(r){var t,e,o,s;return r=null==r?{}:r,r instanceof Object?(t=null==r.adr?"":r.adr,e=null==r.base?i.getBaseUrl():r.base,o=null==r.params?"":n.param(r.params)):(t=r,e=i.getBaseUrl(),o=""),null!=e&&""!==e&&"/"!==e&&"/"===t.charAt(0)?("/"===e.charAt(e.length-1)&&(t=t.substring(1)),s=e+t):s=t,o&&(o=(s.indexOf("?")>=0?"&":"?")+o),s+o};var o=function(r){var t=r.split(".");if(0===t.length)throw new Error("Invalid module name '"+r+"'");for(var e,n,i=units,o=0,s=t.length;o<s;o++){if(n=t[o],void 0===(e=i[n]))throw new Error("Can't find the specified module '"+r+"'");i=e}return e};r.exports=i},function(r,t,e){e(5),e(3),e(4),r.exports=e(6)}])});