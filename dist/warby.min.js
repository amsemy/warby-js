!function(a){"use strict";function b(a){function b(a,c,e,f,g){for(var h in f)"__self__"===h?f.__self__.length&&(e.__self__=e.__self__||{},e.__self__[c]=!0,a.model.set(g+"$"+c,!0)):(e[h]=e[h]||{},b(a,c,e[h],f[h],g+h+"_"));d(a,e,g)}function c(a,b,e,g){for(var h in e)if("__self__"===h)for(var i=b.length-1;i>=0;i--){var j=b[i];delete e.__self__[j],a.model.unset(g+"$"+j)}else f.isObject(e[h])&&c(a,b,e[h],g+h+"_");d(a,e,g)}function d(a,b,c){var d,e=!0;b.__self__=b.__self__||{};for(d in b.__self__)"invalid"!==d&&"valid"!==d&&b.__self__[d]&&(e=!1);if(e)for(d in b)"__self__"!==d&&b[d].__self__.invalid&&(e=!1);b.__self__.invalid=!e,b.__self__.valid=e,a.model.set(c+"$invalid",!e),a.model.set(c+"$valid",e)}var e=a.lib.Backbone,f=a.lib._,g=function(){this.model=new e.Model({$invalid:!1,$valid:!0}),this.status={__self__:{invalid:!1,valid:!0}}};return g.prototype.loadErrors=function(a,c,e){var f=[],g=[this.status];if(null!=e)for(var h=e.split("."),i=0,j=h.length;j>i;i++){var k=h[i];if(""===k)throw new Error("Invalid base '"+e+"'");if("__self__"===k)throw new Error("Mustn't use '__self__' in base '"+e+"'");var l=g[i];l[k]=l[k]||{},g.push(l[k]),f.push(k)}for(b(this,a,g.pop(),c,f.length?f.join("_")+"_":""),i=f.length-1;i>=0;i--)d(this,g[i],i?f.slice(0,i).join("_")+"_":"")},g.prototype.removeErrors=function(a,b){var e=[],g=[this.status];if(f.isArray(a)||(a=[a]),null!=b)for(var h=b.split("."),i=0,j=h.length;j>i;i++){var k=h[i];if(""===k)throw new Error("Invalid base '"+b+"'");if("__self__"===k)throw new Error("Mustn't use '__self__' in base '"+b+"'");var l=g[i];l[k]=l[k]||{},g.push(l[k]),e.push(k)}for(c(this,a,g.pop(),e.length?e.join("_")+"_":""),i=e.length-1;i>=0;i--)d(this,g[i],i?e.slice(0,i).join("_")+"_":"")},g.prototype.set=function(a,b){for(var c=a.split("."),e=[],f=[this.status],g=0,h=c.length;h>g;g++){var i=c[g];if(""===i)throw new Error("Invalid keypath '"+a+"'");if("__self__"===i)throw new Error("Mustn't use '__self__' in keypath '"+a+"'");var j=f[g];if(g+1===h){j.__self__=j.__self__||{},j.__self__[i]=b,this.model.set((g?e.join("_")+"_$":"$")+i,b);break}j[i]=j[i]||{},f.push(j[i]),e.push(i)}for(g=f.length-1;g>=0;g--)d(this,f[g],g?e.slice(0,g).join("_")+"_":"")},g}var c=a.unit("com.github.amsemy.warby.ValidityStatus",b);c.require("lib.*")}(gumup),function(a){"use strict";function b(a){function b(a){return function(b,c,d){var e={};e[a]=c,b.validate(e,d)}}var c=a.lib.Backbone,d=a.com.github.amsemy.warby.ValidityStatus,e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return c.Model.extend({constructor:function(){c.Model.apply(this,arguments);var a=this;for(var e in this.attributes)this.on("change:"+e,b(e));this.errors={},this.handlers={error:function(b){b&&b.errors?(a.errors=b.errors,a.validityStatus.loadErrors("serviceValidity",b.errors)):(a.errors={},a.validityStatus.set("serviceError",!0))}},this.validityStatus=new d},assertEmail:function(a,b){return this.makeValidation(a,e.test(b))},makeValidation:function(a,b){return this.validityStatus.set(a,!b),b},validate:function(){return this.validityStatus.removeErrors(["serviceError","serviceValidity"]),this.errors={},this.validityStatus.status.__self__.invalid?"Form is invalid":void 0}})}var c=a.unit("com.github.amsemy.warby.Form",b);c.require("com.github.amsemy.warby.ValidityStatus"),c.require("lib.*")}(gumup),function(a){"use strict";function b(a){var b=a.lib.$,c={__config:null};c.createWidget=function(a){return new(d(a.constructor))(a)},c.getBaseUrl=function(){var a=b("base").attr("href")||"";return a&&"/"!==a.charAt(a.length-1)?a+"/":a},c.getConfig=function(){return null==this.__config&&(this.__config=JSON.parse(b(".template-config").html())),this.__config},c.getLang=function(){var a=this.getConfig().lang;return null==a?"en":a},c.directTo=function(a){var c,d,e;a=null==a?{}:a,a instanceof Object?(c=null==a.method?"get":a.method,d=null==a.params?{}:a.params,e=null==a.url?"":a.url):(c="get",d={},e=null==a?"":a);var f=b('<form class="hidden" method="'+c+'" action="'+e+'"></form>').appendTo(b("body"));if(d instanceof Array)for(var g=0,h=d.length;h>g;g++)f.append('<input name="'+d[g].name+'" value="'+d[g].value+'">');else for(var i in d)if(d[i]instanceof Array)for(var j=0,k=d[i].length;k>j;j++)f.append('<input name="'+i+'" value="'+d[i][j]+'">');else f.append('<input name="'+i+'" value="'+d[i]+'">');f.submit()},c.url=function(a){var d,e,f,g;return a=null==a?{}:a,a instanceof Object?(d=null==a.adr?"":a.adr,e=null==a.base?c.getBaseUrl():a.base,f=null==a.params?"":b.param(a.params)):(d=a,e=c.getBaseUrl(),f=""),null!=e&&""!==e&&"/"!==e&&"/"===d.charAt(0)?("/"===e.charAt(e.length-1)&&(d=d.substring(1)),g=e+d):g=d,f&&(f=(g.indexOf("?")>=0?"&":"?")+f),g+f};var d=function(b){var c=b.split(".");if(0===c.length)throw new Error("Invalid module name '"+b+"'");for(var d,e,f=a,g=0,h=c.length;h>g;g++){if(e=c[g],d=f[e],void 0===d)throw new Error("Can't find the specified module '"+b+"'");f=d}return d};return c}var c=a.unit("com.github.amsemy.warby.template",b);c.require("lib.*")}(gumup),function(a){"use strict";function b(a){function b(a,b,c){for(var d=c.split("."),e=0,f=d.length;f>e;e++){var g=d[e];e===f-1?b[g]=a[g]:(b[g]=b[g]||{},a=a[g],b=b[g])}}function c(a,b){if(a.api){var d=a.api[b];return d||(d=c(a.constructor.__super__,b)),d}}function d(a,b){if(a.apiMapping){var c=a.apiMapping[b];return c||(c=d(a.constructor.__super__,b)),c}}function e(a,b){for(var c=b.split("."),d=a,e=0,f=c.length;f>e;e++)d=d[c[e]];return d}function f(a,c){var d={};if(i.isArray(c))for(var f=0,g=c.length;g>f;f++)b(a,d,c[f]);else for(var h in c)d[c[h]]=e(a,h);return d}function g(a,b,c){var d=a.url,f=c.path;if(f.length>0){"/"===d.charAt(d.length-1)&&(d=d.substring(0,d.length-1));for(var g=f.split("/"),h=0,i=g.length;i>h;h++){var j,k=g[h];j="{"===k.charAt(0)&&"}"===k.charAt(k.length-1)?e(b,k.substring(1,k.length-1)):k,""!==j.toString()&&(d+="/"+encodeURIComponent(j))}"/"===f.charAt(f.length-1)&&(d+="/")}return d}var h=a.lib.Backbone,i=a.lib._,j=a.com.github.amsemy.warby.template,k=function(){};return i.extend(k.prototype,{url:null,api:{},apply:function(a,b){var d=c(this,a);return d?d.func.apply(this,b):void 0},bind:function(a){a&&(a.service=this,a.sync=function(){return k.sync.apply(this,arguments)})},call:function(a){var b=c(this,a);if(b){if(arguments.length>1){var d=Array.prototype.slice.call(arguments,1);return b.func.apply(this,d)}return b.func.call(this)}},provider:null}),k.extend=h.Model.extend,k.sync=function(a,b,e){if(e||(e={}),e.apiMethod)a=e.apiMethod;else if(a=d(b,a),!a)throw new Error("Unsupported sync method '"+a+"'");var k=c(b.service,a);if(!k)throw new Error("Unsupported API method '"+a+"'");var l=void 0!==k.provider?k.provider:b.service.provider;l&&l(b,e);var m=i.extend(b.toJSON(e),e.attrs),n=k.type,o=g(b.service,m,k);k.params&&(o=j.url({adr:o,base:"",params:f(m,k.params)}));var p={dataType:"json",type:n,url:o};void 0!==e.data||!b||"POST"!==n&&"PUT"!==n&&"PATCH"!==n||(p.contentType="application/json",p.data=JSON.stringify(e.attrs||b.toJSON(e)),p.processData=!1);var q=e.xhr=h.ajax(i.extend(p,e));return b.trigger("request",b,q,e),q},k}var c=a.unit("com.github.amsemy.warby.Service",b);c.require("com.github.amsemy.warby.template"),c.require("lib.*")}(gumup);
//# sourceMappingURL=warby.min.map