!function(a){"use strict";function b(a){var b=a.lib.$,c=function(a){if(a=null==a?{}:a,null==a.name||""===a.name)throw new Error("Undefined 'settings.name' param");this._name=a.name};return c.prototype.getWidgetObj=function(){return b("#"+this._name)},c}var c=a.unit("com.github.amsemy.warby.unit.Widget",b);c.require("lib.*")}(gumup),function(a){"use strict";function b(a){var b=a.com.github.amsemy.warby.unit.Widget,c=function(a){a=null==a?{}:a,a.name=null==a.name?"content-widget":a.name,b.call(this,a)};return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c}var c=a.unit("com.github.amsemy.warby.unit.View",b);c.require("com.github.amsemy.warby.unit.Widget")}(gumup),function(a){"use strict";a.unit("com.github.amsemy.warby.response.FailureResponse",function(){return function(){}})}(gumup),function(a){"use strict";a.unit("com.github.amsemy.warby.response.InvalidResponse",function(){return function(a){this.errors=a.errors}})}(gumup),function(a){"use strict";a.unit("com.github.amsemy.warby.response.SuccessResponse",function(){return function(a){this.data=a.data}})}(gumup),function(a){"use strict";function b(a){var b=a.lib.$,c={__config:null};c.createWidget=function(a){return new(d(a.constructor))(a)},c.getBaseUrl=function(){var a=b("base").attr("href")||"";return a&&"/"!==a.charAt(a.length-1)?a+"/":a},c.getConfig=function(){return null==this.__config&&(this.__config=JSON.parse(b(".template-config").html())),this.__config},c.getLang=function(){var a=this.getConfig().lang;return null==a?"en":a},c.directTo=function(a){var c,d,e;a=null==a?{}:a,a instanceof Object?(c=null==a.method?"get":a.method,d=null==a.params?{}:a.params,e=null==a.url?"":a.url):(c="get",d={},e=null==a?"":a);var f=b('<form class="hidden" method="'+c+'" action="'+e+'"></form>').appendTo(b("body"));if(d instanceof Array)for(var g=0,h=d.length;h>g;g++)f.append('<input name="'+d[g].name+'" value="'+d[g].value+'">');else for(var i in d)if(d[i]instanceof Array)for(var j=0,k=d[i].length;k>j;j++)f.append('<input name="'+i+'" value="'+d[i][j]+'">');else f.append('<input name="'+i+'" value="'+d[i]+'">');f.submit()},c.url=function(a){var d,e,f,g;return a=null==a?{}:a,a instanceof Object?(d=null==a.adr?"":a.adr,e=null==a.base?c.getBaseUrl():a.base,f=null==a.params?"":b.param(a.params)):(d=a,e=c.getBaseUrl(),f=""),null!=e&&""!==e&&"/"!==e&&"/"===d.charAt(0)?("/"===e.charAt(e.length-1)&&(d=d.substring(1)),g=e+d):g=d,f&&(f=(g.indexOf("?")>=0?"&":"?")+f),g+f};var d=function(b){var c=b.split(".");if(0===c.length)throw new Error("Invalid module name '"+b+"'");for(var d,e,f=a,g=0,h=c.length;h>g;g++){if(e=c[g],d=f[e],void 0===d)throw new Error("Can't find the specified module '"+b+"'");f=d}return d};return c}var c=a.unit("com.github.amsemy.warby.template",b);c.require("lib.*")}(gumup),function(a){"use strict";function b(a){function b(a,b,c){for(var d=c.split("."),e=0,f=d.length;f>e;e++){var g=d[e];e===f-1?b[g]=a[g]:(b[g]=b[g]||{},a=a[g],b=b[g])}}function c(a,b){if(a.api){var d=a.api[b];return d||(d=c(a.constructor.__super__,b)),d}}function d(a,b){if(a.apiMapping){var c=a.apiMapping[b];return c||(c=d(a.constructor.__super__,b)),c}}function e(a,b){for(var c=b.split("."),d=a,e=0,f=c.length;f>e;e++)d=d[c[e]];return d}function f(a,c){var d={};if(j.isArray(c))for(var f=0,g=c.length;g>f;f++)b(a,d,c[f]);else for(var h in c)d[c[h]]=e(a,h);return d}function g(a,b,c){var d=a.url,f=c.path.split("/"),g=f.length;if(!g)throw new Error("Invalid API function URL");d+="/"+f[0];for(var h=1;g>h;h++){var i=f[h],j=i.substring(1,i.length-1);d+="/"+("{"===i.charAt(0)&&"}"===i.charAt(i.length-1)?e(b,j):i)}return d}function h(a){switch(a.status){case"INVALID":return new l(a);case"SUCCESS":return new m(a);default:return new k}}var i=a.lib.Backbone,j=a.lib._,k=a.com.github.amsemy.warby.response.FailureResponse,l=a.com.github.amsemy.warby.response.InvalidResponse,m=a.com.github.amsemy.warby.response.SuccessResponse,n=a.com.github.amsemy.warby.template,o=function(){};return j.extend(o.prototype,{url:null,api:{},apply:function(a,b){var d=c(this,a);return d?d.func.apply(this,b):void 0},call:function(a){var b=c(this,a);if(b){if(arguments.length>1){var d=Array.prototype.slice.call(arguments,1);return b.func.apply(this,d)}return b.func.call(this)}},persist:function(a){a&&(a.service=this,a.sync=function(){return o.sync.apply(this,arguments)})}}),o.extend=i.Model.extend,o.sync=function(a,b,e){e||(e={});var k=j.extend(b.toJSON(e),e.attrs),l=e.func;if(!e.func&&(l=d(b,a),!l))throw new Error("Unsupported sync method '"+a+"'");var o=c(b.service,l);if(!o)throw new Error("Unsupported API function '"+l+"'");var p=o.type,q=g(b.service,k,o);o.params&&(q=n.url({adr:q,base:"",params:f(k,o.params)}));var r={dataType:"json",type:p,url:q};void 0!==e.data||!b||"POST"!==p&&"PUT"!==p&&"PATCH"!==p||(r.contentType="application/json",r.data=JSON.stringify(e.attrs||b.toJSON(e)),r.processData=!1);var s=e.success;e.success=function(a){var b=h(a);b instanceof m?s&&s(b.data):e.error&&e.error(b)};var t=e.xhr=i.ajax(j.extend(r,e));return b.trigger("request",b,t,e),t},o}var c=a.unit("com.github.amsemy.warby.Service",b);c.require("com.github.amsemy.warby.response.FailureResponse"),c.require("com.github.amsemy.warby.response.InvalidResponse"),c.require("com.github.amsemy.warby.response.SuccessResponse"),c.require("com.github.amsemy.warby.template"),c.require("lib.*")}(gumup),function(a){"use strict";function b(a){function b(a,c,e,f,g){for(var h in f)"__self__"===h?f.__self__.length&&(e.__self__=e.__self__||{},e.__self__[c]=!0,a.model.set(g+"$"+c,!0)):(e[h]=e[h]||{},b(a,c,e[h],f[h],g+h+"_"));d(a,e,g)}function c(a,b,e,g){for(var h in e)if("__self__"===h)for(var i=b.length-1;i>=0;i--){var j=b[i];delete e.__self__[j],a.model.unset(g+"$"+j)}else f.isObject(e[h])&&c(a,b,e[h],g+h+"_");d(a,e,g)}function d(a,b,c){var d,e=!0;b.__self__=b.__self__||{};for(d in b.__self__)"invalid"!==d&&"valid"!==d&&b.__self__[d]&&(e=!1);if(e)for(d in b)"__self__"!==d&&b[d].__self__.invalid&&(e=!1);b.__self__.invalid=!e,b.__self__.valid=e,a.model.set(c+"$invalid",!e),a.model.set(c+"$valid",e)}var e=a.lib.Backbone,f=a.lib._,g=function(){this.model=new e.Model({$invalid:!1,$valid:!0}),this.status={__self__:{invalid:!1,valid:!0}}};return g.prototype.loadErrors=function(a,c,e){var f=[],g=[this.status];if(null!=e)for(var h=e.split("."),i=0,j=h.length;j>i;i++){var k=h[i];if(""===k)throw new Error("Invalid base '"+e+"'");if("__self__"===k)throw new Error("Mustn't use '__self__' in base '"+e+"'");var l=g[i];l[k]=l[k]||{},g.push(l[k]),f.push(k)}for(b(this,a,g.pop(),c,f.length?f.join("_")+"_":""),i=f.length-1;i>=0;i--)d(this,g[i],i?f.slice(0,i).join("_")+"_":"")},g.prototype.removeErrors=function(a,b){var e=[],g=[this.status];if(f.isArray(a)||(a=[a]),null!=b)for(var h=b.split("."),i=0,j=h.length;j>i;i++){var k=h[i];if(""===k)throw new Error("Invalid base '"+b+"'");if("__self__"===k)throw new Error("Mustn't use '__self__' in base '"+b+"'");var l=g[i];l[k]=l[k]||{},g.push(l[k]),e.push(k)}for(c(this,a,g.pop(),e.length?e.join("_")+"_":""),i=e.length-1;i>=0;i--)d(this,g[i],i?e.slice(0,i).join("_")+"_":"")},g.prototype.set=function(a,b){for(var c=a.split("."),e=[],f=[this.status],g=0,h=c.length;h>g;g++){var i=c[g];if(""===i)throw new Error("Invalid keypath '"+a+"'");if("__self__"===i)throw new Error("Mustn't use '__self__' in keypath '"+a+"'");var j=f[g];if(g+1===h){j.__self__=j.__self__||{},j.__self__[i]=b,this.model.set((g?e.join("_")+"_$":"$")+i,b);break}j[i]=j[i]||{},f.push(j[i]),e.push(i)}for(g=f.length-1;g>=0;g--)d(this,f[g],g?e.slice(0,g).join("_")+"_":"")},g}var c=a.unit("com.github.amsemy.warby.ValidityStatus",b);c.require("lib.*")}(gumup),function(a){"use strict";function b(a){function b(a){return function(b,c,d){var e={};e[a]=c,b.validate(e,d)}}var c=a.lib.Backbone,d=a.com.github.amsemy.warby.response.InvalidResponse,e=a.com.github.amsemy.warby.ValidityStatus,f=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return c.Model.extend({constructor:function(){c.Model.apply(this,arguments);var a=this;for(var f in this.attributes)this.on("change:"+f,b(f));this.errors={},this.handlers={error:function(b){b instanceof d?(a.errors=b.errors,a.validityStatus.loadErrors("serviceValidity",b.errors)):(a.errors={},a.validityStatus.set("serviceError",!0))}},this.validityStatus=new e},assertEmail:function(a,b){return this.assertTrue(a,f.test(b))},assertTrue:function(a,b){return b?this.makeValid(a):this.makeInvalid(a),b},makeInvalid:function(a){this.validityStatus.set(a,!0)},makeValid:function(a){this.validityStatus.set(a,!1)},validate:function(){return this.validityStatus.removeErrors(["serviceError","serviceValidity"]),this.errors={},this.validityStatus.status.__self__.invalid?"Form is invalid":void 0}})}var c=a.unit("com.github.amsemy.warby.Form",b);c.require("com.github.amsemy.warby.ValidityStatus"),c.require("com.github.amsemy.warby.response.InvalidResponse"),c.require("lib.*")}(gumup);
//# sourceMappingURL=warby.min.map